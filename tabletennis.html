<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Table Tennis Match Model &mdash; Set Probabilities to Markets</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page-bg"></div>
  <div class="page-gradient"></div>

  <main class="shell">
    <header class="header">
      <div>
        <h1>Table Tennis Match Model</h1>
        <p>Transform set-level edge into match, totals and handicap odds.</p>
      </div>
      <nav class="top-nav">
        <a href="index.html">Football model</a>
        <a href="snooker.html">Snooker model</a>
      </nav>
    </header>

    <section class="card glass">
      <h2 class="card-title">Match setup</h2>

      <div class="snooker-inputs">
        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Set probability</h3>
            <span class="panel-note">Prematch edge</span>
          </div>
          <div class="input-grid two">
            <div class="input-card">
              <label for="ttSetProb">P(Player A wins set)</label>
              <input type="number" id="ttSetProb" min="0" max="1" step="0.01" value="0.55" inputmode="decimal" />
              <small class="hint">Decimal 0&ndash;1. Example: 0.55 = 55%.</small>
            </div>
            <div class="input-card">
              <label for="ttSetProbB">
                P(Player B wins set
                <span class="badge auto">auto</span>)
              </label>
              <input type="number" id="ttSetProbB" disabled />
              <small class="hint">Mirror: 1 - P(A).</small>
            </div>
          </div>
        </section>

        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Match format</h3>
            <span class="panel-note">Series length + margin</span>
          </div>
          <div class="input-grid two">
            <div class="input-card">
              <label for="ttBestOf">Best-of sets</label>
              <select id="ttBestOf">
                <option value="5" selected>Best of 5 (FT3)</option>
                <option value="7">Best of 7 (FT4)</option>
              </select>
              <small class="hint">Classic ITTF formats.</small>
            </div>
            <div class="input-card">
              <label for="ttMargin">Margin (overround)</label>
              <div class="input-with-suffix">
                <input type="number" id="ttMargin" min="0" max="0.20" step="0.01" value="0.00" inputmode="decimal" />
                <span class="suffix">%</span>
              </div>
              <small class="hint">0 = fair odds. 0.05 â‰ˆ 5% book.</small>
            </div>
          </div>
        </section>
      </div>

      <div class="actions-row">
        <button id="ttCalcBtn">Calculate markets</button>
        <span id="ttStatus" class="status-text" role="status" aria-live="polite"></span>
      </div>
    </section>

    <section class="layout-columns">
      <div class="left-col">
        <section class="card glass">
          <h2 class="card-title">Match winner</h2>
          <div class="prob-grid">
            <div class="prob-card">
              <div class="prob-label">Player A</div>
              <div class="prob-val" id="ttMatchProbA">-</div>
              <div class="odds-odd" id="ttMatchOddsA">-</div>
            </div>
            <div class="prob-card">
              <div class="prob-label">Player B</div>
              <div class="prob-val" id="ttMatchProbB">-</div>
              <div class="odds-odd" id="ttMatchOddsB">-</div>
            </div>
          </div>
        </section>

        <section class="card glass">
          <h2 class="card-title">Sets markets</h2>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Over</th>
                  <th scope="col">Under</th>
                </tr>
              </thead>
              <tbody id="ttTotalsBody">
                <tr>
                  <td colspan="3">Load parameters to see totals</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Handicap lines</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Player A</th>
                  <th scope="col">Player B</th>
                </tr>
              </thead>
              <tbody id="ttHandicapBody">
                <tr>
                  <td colspan="3">Load parameters to see handicaps</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="card glass">
          <h2 class="card-title">Points markets</h2>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Over</th>
                  <th scope="col">Under</th>
                </tr>
              </thead>
              <tbody id="ttPointsTotalsBody">
                <tr>
                  <td colspan="3">Load parameters to see points totals</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Points handicap</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Player A</th>
                  <th scope="col">Player B</th>
                </tr>
              </thead>
              <tbody id="ttPointsHandicapBody">
                <tr>
                  <td colspan="3">Load parameters to see points handicaps</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">First set total</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Over</th>
                  <th scope="col">Under</th>
                </tr>
              </thead>
              <tbody id="ttFirstSetBody">
                <tr>
                  <td colspan="3">Load parameters to see first set totals</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>

      <section class="card glass">
        <h2 class="card-title">Model details</h2>
        <div class="details-grid">
          <div class="detail-row">
            <span>P(A wins set)</span>
            <span id="ttDetailSetProbA" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>P(B wins set)</span>
            <span id="ttDetailSetProbB" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Best of</span>
            <span id="ttDetailBestOf" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>First-to</span>
            <span id="ttDetailFirstTo" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Expected sets</span>
            <span id="ttDetailExpectedSets" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Expected points</span>
            <span id="ttDetailExpectedPoints" class="detail-val">-</span>
          </div>
        </div>

        <p class="footnote">
          Set distribution is computed using an exact negative-binomial model from the set-level probability.
        </p>

        <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Sets distribution</h3>
        <div class="table-scroll">
          <table class="data-table">
            <thead>
              <tr>
                <th scope="col">Sets played</th>
                <th scope="col">P(match ends)</th>
                <th scope="col">P(A wins)</th>
                <th scope="col">P(B wins)</th>
              </tr>
            </thead>
            <tbody id="ttSetsDistBody">
              <tr>
                <td colspan="4">Load parameters to see distribution</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <footer class="footer">
      <small>
        Simple probability model &mdash; no momentum adjustments. Extend with live data as needed.
      </small>
    </footer>
  </main>

  <script src="tabletennis_math.js"></script>
  <script src="tabletennis.js"></script>
</body>
</html>
