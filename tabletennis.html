<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Table Tennis Match Model — Multi-format</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page-bg"></div>
  <div class="page-gradient"></div>

  <main class="shell">
    <header class="header">
      <div>
        <h1>Table Tennis Match Model</h1>
        <p>Transform match odds into BO5/BO7 winner, sets, handicaps, correct score, and points outputs.</p>
      </div>
      <nav class="top-nav">
        <a href="index.html">Football model</a>
        <a href="snooker.html">Snooker model</a>
      </nav>
    </header>

    <section class="card glass">
      <h2 class="card-title">Match setup</h2>

      <div class="snooker-inputs">
        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Format &amp; margins</h3>
            <span class="panel-note">Overround applies to winner + derived markets</span>
          </div>
          <div class="input-grid three">
            <div class="input-card">
              <label for="ttFormat">Format</label>
              <select id="ttFormat">
                <option value="bo5" selected>Best of 5 (first to 3)</option>
                <option value="bo7">Best of 7 (first to 4)</option>
              </select>
              <small class="hint">Switching formats recalculates every market.</small>
            </div>
            <div class="input-card">
              <label for="ttMarginWinner">Match winner margin</label>
              <div class="input-with-suffix">
                <input type="number" id="ttMarginWinner" min="0" max="20" step="0.5" value="5" inputmode="decimal" />
                <span class="suffix">%</span>
              </div>
              <small class="hint">Applied to match odds + auto away price.</small>
            </div>
            <div class="input-card">
              <label for="ttMarginBinary">Other binary markets</label>
              <div class="input-with-suffix">
                <input type="number" id="ttMarginBinary" min="0" max="20" step="0.5" value="5" inputmode="decimal" />
                <span class="suffix">%</span>
              </div>
              <small class="hint">First set + handicaps.</small>
            </div>
          </div>
          <div class="input-grid one" style="margin-top:12px;">
            <div class="input-card">
              <label for="ttMarginMulti">Multi-way markets</label>
              <div class="input-with-suffix">
                <input type="number" id="ttMarginMulti" min="0" max="20" step="0.5" value="7" inputmode="decimal" />
                <span class="suffix">%</span>
              </div>
              <small class="hint">Correct score + total sets.</small>
            </div>
          </div>
        </section>

        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Match odds</h3>
            <span class="panel-note">Decimal prices &gt; 1.00</span>
          </div>
          <div class="input-grid three">
            <div class="input-card">
              <label for="ttOddsHome">Player A odds</label>
              <input type="number" id="ttOddsHome" min="1.01" step="0.01" value="1.65" inputmode="decimal" />
              <small class="hint">Entering Player A auto-fills Player B using the winner margin.</small>
            </div>
            <div class="input-card">
              <label for="ttOddsAway">Player B odds</label>
              <input type="number" id="ttOddsAway" min="1.01" step="0.01" value="2.20" inputmode="decimal" />
              <small class="hint">Editable; will be refreshed when Player A changes.</small>
            </div>
          </div>
        </section>
      </div>

      <div class="actions-row">
        <button id="ttCalcBtn">Calculate markets</button>
        <span id="ttStatus" class="status-text" role="status" aria-live="polite"></span>
      </div>
    </section>

    <section class="layout-columns">
      <div class="left-col">
        <section class="card glass">
          <h2 class="card-title">Match winner</h2>
          <div class="prob-grid">
            <div class="prob-card">
              <div class="prob-label">Player A</div>
              <div class="prob-val" id="ttMatchProbA">-</div>
              <div class="odds-odd" id="ttMatchOddsA">-</div>
            </div>
            <div class="prob-card">
              <div class="prob-label">Player B</div>
              <div class="prob-val" id="ttMatchProbB">-</div>
              <div class="odds-odd" id="ttMatchOddsB">-</div>
            </div>
          </div>
        </section>

        <section class="card glass">
          <h2 class="card-title">First set winner</h2>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Outcome</th>
                  <th scope="col">Probability</th>
                  <th scope="col">Odds</th>
                </tr>
              </thead>
              <tbody id="ttFirstSetBody">
                <tr>
                  <td colspan="3">Load parameters to see first set prices</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>

        <section class="card glass">
          <h2 class="card-title">Total sets markets</h2>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Outcome</th>
                  <th scope="col">Probability</th>
                  <th scope="col">Odds</th>
                </tr>
              </thead>
              <tbody id="ttTotalsBody">
                <tr>
                  <td colspan="3">Load parameters to see totals</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">O/U lines</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Over</th>
                  <th scope="col">Under</th>
                </tr>
              </thead>
              <tbody id="ttTotalsOuBody">
                <tr>
                  <td colspan="3">Load parameters to see lines</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Handicap lines</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Player A</th>
                  <th scope="col">Player B</th>
                </tr>
              </thead>
              <tbody id="ttHandicapBody">
                <tr>
                  <td colspan="3">Load parameters to see handicaps</td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="details-grid" style="margin-top:16px;">
            <div class="detail-row">
              <span>Expected set points</span>
              <span id="ttPointsPerSet" class="detail-val">-</span>
            </div>
            <div class="detail-row">
              <span>Expected match points</span>
              <span id="ttPointsExpected" class="detail-val">-</span>
            </div>
            <div class="detail-row">
              <span>Expected points handicap</span>
              <span id="ttPointsHandicap" class="detail-val">-</span>
            </div>
          </div>
        </section>
      </div>

      <section class="card glass">
        <h2 class="card-title">Correct score &amp; expectations</h2>
        <div class="table-scroll">
          <table class="data-table">
            <thead>
              <tr>
                <th scope="col">Score</th>
                <th scope="col">Probability</th>
                <th scope="col">Odds</th>
              </tr>
            </thead>
            <tbody id="ttCorrectScoreBody">
              <tr>
                <td colspan="3">Load parameters to see correct score</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="details-grid" style="margin-top:16px;">
          <div class="detail-row">
            <span>Expected match points</span>
            <span id="ttPointsExpected" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Expected points handicap</span>
            <span id="ttPointsHandicap" class="detail-val">-</span>
          </div>
        </div>
      </section>
    </section>

    <section class="card glass">
      <h2 class="card-title">Model details</h2>
      <div class="details-grid">
        <div class="detail-row">
          <span>P(A wins set)</span>
          <span id="ttDetailSetProbA" class="detail-val">-</span>
        </div>
        <div class="detail-row">
          <span>P(B wins set)</span>
          <span id="ttDetailSetProbB" class="detail-val">-</span>
        </div>
        <div class="detail-row">
          <span>Expected sets</span>
          <span id="ttDetailExpectedSets" class="detail-val">-</span>
        </div>
        <div class="detail-row">
          <span>Expected points</span>
          <span id="ttDetailExpectedPoints" class="detail-val">-</span>
        </div>
      </div>

      <p class="footnote" id="ttFormatNote">
        Model assumes a BO5 (first-to-three sets) format and derives set probabilities from the implied fair match price.
      </p>

      <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Sets distribution</h3>
      <div class="table-scroll">
        <table class="data-table">
          <thead>
            <tr>
              <th scope="col">Sets played</th>
              <th scope="col">P(match ends)</th>
              <th scope="col">P(A wins)</th>
              <th scope="col">P(B wins)</th>
            </tr>
          </thead>
          <tbody id="ttSetsDistBody">
            <tr>
              <td colspan="4">Load parameters to see distribution</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <footer class="footer">
      <small>
        Expected points are derived as <strong>18.6 × expected sets</strong>. Extend with live data as needed.
      </small>
    </footer>
  </main>

  <script src="tableTennisEngine.js"></script>
  <script src="tabletennis.js"></script>
</body>
</html>
