<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Snooker Match Model &mdash; Frame Probabilities to Odds</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="page-bg"></div>
  <div class="page-gradient"></div>

  <main class="shell">
    <header class="header">
      <div>
        <h1>Snooker Match Model</h1>
        <p>Transform frame-level edge into match winner, totals and handicap markets.</p>
      </div>
      <nav class="top-nav">
        <a href="index.html" aria-label="Switch to football model">Football model</a>
        <a href="tabletennis.html">Table tennis model</a>
      </nav>
    </header>

    <section class="card glass">
      <h2 class="card-title">Match setup</h2>

      <div class="snooker-inputs">
        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Frame probabilities</h3>
            <span class="panel-note">Model edge lives here</span>
          </div>
          <div class="input-grid two">
            <div class="input-card">
              <label for="frameProbA">P(Player A wins frame)</label>
              <input type="number" id="frameProbA" min="0" max="1" step="0.01" value="0.60" inputmode="decimal" />
              <small class="hint">Decimal 0&ndash;1. Example: 0.60 = 60%.</small>
            </div>
            <div class="input-card">
              <label for="frameProbB">
                P(Player B wins frame)
                <span class="badge auto">auto</span>
              </label>
              <input type="number" id="frameProbB" disabled />
              <small class="hint">Mirror: 1 - P(A).</small>
            </div>
          </div>
        </section>

        <section class="input-panel">
          <div class="input-panel-header">
            <h3>Match context</h3>
            <span class="panel-note">Format + pricing margin</span>
          </div>
          <div class="input-grid two">
            <div class="input-card">
              <label for="bestOfSelect">Best-of format</label>
              <select id="bestOfSelect">
                <option value="7">Best of 7 (FT4)</option>
                <option value="9" selected>Best of 9 (FT5)</option>
                <option value="11">Best of 11 (FT6)</option>
                <option value="19">Best of 19 (FT10)</option>
                <option value="25">Best of 25 (FT13)</option>
                <option value="33">Best of 33 (FT17)</option>
              </select>
              <small class="hint">Standard tour match lengths.</small>
            </div>
            <div class="input-card">
              <label for="snookerMargin">Margin (overround)</label>
              <div class="input-with-suffix">
                <input type="number" id="snookerMargin" min="0" max="0.15" step="0.01" value="0.00" inputmode="decimal" />
                <span class="suffix">%</span>
              </div>
              <small class="hint">0 = fair odds. 5% market margin &asymp; 0.05.</small>
            </div>
          </div>
        </section>

        <section class="input-panel">
          <div class="input-panel-header">
            <h3>In-play dynamics</h3>
            <span class="panel-note">Score & momentum effects</span>
          </div>
          <div class="input-grid">
            <div class="input-card">
              <label>Current frames (in-play score)</label>
              <div class="score-grid">
                <div class="score-box">
                  <span class="score-label">Player A</span>
                  <input type="number" id="currentFramesA" min="0" value="0" step="1" inputmode="numeric" />
                </div>
                <div class="score-box">
                  <span class="score-label">Player B</span>
                  <input type="number" id="currentFramesB" min="0" value="0" step="1" inputmode="numeric" />
                </div>
              </div>
              <small class="hint">Must be less than total frames for the match.</small>
            </div>

            <div class="input-card">
              <label for="momentumBoost">Momentum tilt</label>
              <input type="range" id="momentumBoost" min="-0.15" max="0.15" step="0.01" value="0" />
              <div class="range-meta">
                <span>Lean B</span>
                <span class="range-value" id="momentumValue">0%</span>
                <span>Lean A</span>
              </div>
              <small class="hint">Positive boosts Player A per frame advantage.</small>
            </div>

            <div class="input-card">
              <label for="pressureFactor">Pressure factor</label>
              <input type="range" id="pressureFactor" min="0" max="0.2" step="0.01" value="0" />
              <div class="range-meta">
                <span>Calm</span>
                <span class="range-value" id="pressureValue">0%</span>
                <span>Intense</span>
              </div>
              <small class="hint">Amplifies the player closer to the finish line.</small>
            </div>
          </div>
        </section>
      </div>

      <div class="actions-row">
        <button id="snookerCalcBtn">Calculate markets</button>
        <span id="snookerStatus" class="status-text" role="status" aria-live="polite"></span>
      </div>
    </section>

    <section class="layout-columns">
      <div class="left-col">
        <section class="card glass">
          <h2 class="card-title">Match winner</h2>
          <div class="prob-grid">
            <div class="prob-card">
              <div class="prob-label">Player A</div>
              <div class="prob-val" id="snookerMatchProbA">-</div>
              <div class="odds-odd" id="snookerMatchOddsA">-</div>
            </div>
            <div class="prob-card">
              <div class="prob-label">Player B</div>
              <div class="prob-val" id="snookerMatchProbB">-</div>
              <div class="odds-odd" id="snookerMatchOddsB">-</div>
            </div>
          </div>
        </section>

        <section class="card glass">
          <h2 class="card-title">Frames markets</h2>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Over</th>
                  <th scope="col">Under</th>
                </tr>
              </thead>
              <tbody id="snookerTotalsBody">
                <tr>
                  <td colspan="3">Load a matchup to see totals</td>
                </tr>
              </tbody>
            </table>
          </div>

          <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Handicap lines</h3>
          <div class="table-scroll">
            <table class="data-table">
              <thead>
                <tr>
                  <th scope="col">Line</th>
                  <th scope="col">Player A</th>
                  <th scope="col">Player B</th>
                </tr>
              </thead>
              <tbody id="snookerHandicapBody">
                <tr>
                  <td colspan="3">Load a matchup to see handicaps</td>
                </tr>
              </tbody>
            </table>
          </div>
        </section>
      </div>

      <section class="card glass">
        <h2 class="card-title">Model details</h2>
        <div class="details-grid">
          <div class="detail-row">
            <span>P(A wins frame)</span>
            <span id="detailFrameProbA" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>P(B wins frame)</span>
            <span id="detailFrameProbB" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Best of</span>
            <span id="detailBestOf" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>First-to</span>
            <span id="detailFirstTo" class="detail-val">-</span>
          </div>
          <div class="detail-row">
            <span>Expected frames</span>
            <span id="detailExpectedFrames" class="detail-val">-</span>
          </div>
        </div>

        <p class="footnote">
          Match and frames distribution are computed from a frame-level Bernoulli model
          with exact first-to-K logic.
        </p>

        <h3 class="card-title" style="margin-top:14px;font-size:1rem;">Frames distribution</h3>
        <div class="table-scroll">
          <table class="data-table">
            <thead>
              <tr>
                <th scope="col">Frames</th>
                <th scope="col">P(match ends)</th>
                <th scope="col">P(A wins)</th>
                <th scope="col">P(B wins)</th>
              </tr>
            </thead>
            <tbody id="framesDistBody"></tbody>
          </table>
        </div>
      </section>
    </section>

    <footer class="footer">
      <small>Pure probability model, no in-play dynamics. Add momentum / pressure factors later if needed.</small>
    </footer>
  </main>

  <script src="snooker_math.js"></script>
  <script src="snooker.js"></script>
</body>
</html>
